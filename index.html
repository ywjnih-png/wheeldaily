<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Daily Daget! üéÅ</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body {
  background: radial-gradient(circle, #0a1a2f, black);
  color: white;
  font-family: Arial;
  text-align: center;
}

.card {
  max-width: 420px;
  background: #020617;
  border: 2px solid gold;
  border-radius: 20px;
  margin: 60px auto;
  padding: 25px;
  box-shadow: 0 0 30px gold;
}

input, button {
  margin-top: 15px;
  padding: 12px;
  width: 90%;
  border-radius: 10px;
  border: none;
  text-align: center;
}

button {
  background: gold;
  font-weight: bold;
  cursor: pointer;
}

.kado {
  font-size: 50px;
  display: inline-block;
  margin: 10px;
  cursor: pointer;
  animation: goyang 1s infinite;
}

@keyframes goyang {
  0% { transform: rotate(-5deg); }
  50% { transform: rotate(5deg); }
  100% { transform: rotate(-5deg); }
}
</style>
</head>

<body>
<div class="card" id="step1">
  <h1>üéÅ Daily Daget!</h1>
  <input id="kode" placeholder="Masukkan Kode">
  <button onclick="cekKode()">BUKA KADO</button>
  <p id="status"></p>
</div>

<div class="card" id="step2" style="display:none">
  <h2>Pilih Salah Satu Kado!</h2>
  <div id="kadoList"></div>
</div>

<div class="card" id="step3" style="display:none">
  <h2>üéâ SELAMAT!</h2>
  <h1 id="hasil"></h1>
  <p>‚ö†Ô∏è WAJIB SCREENSHOT HALAMAN INI SAAT KLAIM</p>
  <button id="waBtn">KLAIM KE WHATSAPP</button>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDiaWaVLr88PapSzS2-yDQOsD1PKD1510s",
  authDomain: "daget-8aa90.firebaseapp.com",
  projectId: "daget-8aa90"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let hadiah = "";
let kodeAktif = "";

function cekKode() {
  const kode = document.getElementById("kode").value;
  db.collection("codes").doc(kode).get().then(doc => {
    if (!doc.exists) {
      status.innerText = "‚ùå Kode tidak valid";
    } else if (doc.data().used) {
      status.innerText = "‚ùå Kode sudah dipakai";
    } else {
      kodeAktif = kode;
      hadiah = doc.data().saldo;
      step1.style.display = "none";
      step2.style.display = "block";
      tampilkanKado();
    }
  });
}

function tampilkanKado() {
  let html = "";
  for (let i = 0; i < 5; i++) {
    html += `<span class="kado" onclick="buka()">üéÅ</span>`;
  }
  kadoList.innerHTML = html;
}

function buka() {
  db.collection("codes").doc(kodeAktif).update({ used: true });
  step2.style.display = "none";
  step3.style.display = "block";
  hasil.innerText = hadiah;

  const text = `Halo Admin Daily Daget!

Saya mau klaim hadiah dengan data:
Nama:
Nomor Rekening / E-Wallet:
Hadiah: ${hadiah}

Saya lampirkan screenshot sebagai bukti.`;

  waBtn.onclick = function() {
    window.open("https://wa.me/6281376508126?text=" + encodeURIComponent(text));
  };
}
</script>
</body>
</html>